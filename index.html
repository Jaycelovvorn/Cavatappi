<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <style>
  #comments-overlay { position: fixed; inset: 0; display: none; z-index: 9999; align-items: center; justify-content: center; }
  #comments-overlay.show { display: flex; }
  #comments-overlay .backdrop { position: absolute; inset: 0; background: rgba(2,6,23,0.6); backdrop-filter: blur(4px); }
  #comments-overlay .panel {
    position: relative;
    width: min(1100px, 94vw);
    height: min(820px, 90vh);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(2,6,23,0.7);
    background: transparent;
    border: 1px solid rgba(125,211,252,0.06);
  }
  #comments-overlay iframe {
    width: 100%;
    height: 100%;
    border: 0;
    background: transparent;
  }
  #comments-overlay .close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 2;
    background: linear-gradient(135deg,#0b1220 0%,#10243a 100%);
    color: #7dd3fc;
    border: 1px solid #7dd3fc;
    border-radius: 8px;
    padding: 6px 10px;
    cursor: pointer;
    box-shadow: 0 0 8px #7dd3fc55;
  }

  .tabs {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .tabs button {
    background: linear-gradient(135deg,#0b1220 0%,#10243a 100%);
    color: #7dd3fc;
    border: 1px solid #7dd3fc;
    border-radius: 8px;
    padding: 6px 10px;
    cursor: pointer;
    box-shadow: 0 0 8px #7dd3fc55;
    font-size: 14px;
  }
  </style>
  <title>16-bit Adder/Subtractor</title>
</head>
<body>
  <div id="comments-overlay" aria-hidden="true">
    <div class="backdrop" data-role="backdrop"></div>
    <div class="panel" role="dialog" aria-modal="true">
      <button class="close-btn" aria-label="Close comments">✕</button>
      <iframe id="comments-iframe" src="comments.html" title="Comments (overlay)"></iframe>
    </div>
  </div>

  <div class="live">It lives...?</div>
  <div class="row app">
    <header>
      <h1>16-bit Adder / Subtractor / Multiplier / Divider</h1>
      <div class="small muted">Gate-level add/sub; shift-add multiply; long division for div</div>
    </header>
    <div class="controls">
      <label>A <input id="A" type="number" min="0" max="65535" value="0"></label>
      <label>B <input id="B" type="number" min="0" max="65535" value="0"></label>
      <label>Op
        <select id="OP">
          <option value="ADD">Add</option>
          <option value="SUB">Subtract</option>
          <option value="MUL">Multiply</option>
          <option value="DIV">Divide</option>
        </select>
      </label>
      <button id="compute">Compute</button>

      <div class="tabs" aria-hidden="false">
        <button id="comments-toggle" aria-expanded="false">Comments</button>
      </div>

    </div>
  </div>
  <div class="cards">
    <div class="card">
      <h3>Result</h3>
  <div id="resultDisplay" class="small">—</div>
  <div class="flags" id="flags"></div>
  <h4>Binary</h4>
  <pre id="binary" class="binary"></pre>
  <div class="container calign">
<section>
    <b>Project</b>
<hr>
From looking up things about logic gates and 16bit calculators using them, I discovered the programming language called VHDL. VHDL is an acronym for VHSIC Hardware Description Language, or Very High Speed Integrated Circuits Hardware Descriptive Language. As the name suggests, it simulates and synthesizes digital electronic systems; in other words, logic gates. Due to this relation to my main project, instead of using that python calculator to represent what the logic gate were doing, I learned the necessary parts of VHDL to code it in that instead. What you see is a VHDL, python, HTML stack.
<div class="img-row">
        <img src="https://i.postimg.cc/4ynZJvgh/image-2025-11-17-013236187.png" alt="Calculator Spaghetti Interpreter Code">
      </div>
      <p class="caption">Sample of my current python</p>
</section>
<section>
    <b>ME<span style="color:grey;font-size:8px">.md</span></b>
<hr>
I am horrible at fixing code. Especially HTML. It took me two days to figure out why I couldn't add text here before I realized I set the z-index higher than the paragraph tag. It also took an unbelievable amount time to realize I had no way to have comments since the native comment box is covered. Despite spending hours having been clueless about all of the problems I ran into (and probably will still run in to), I think making this has been surprisingly fun even though I have no idea what I'm doing.
<div class="img-row">
        <img src="https://i.postimg.cc/0QwFZtP3/image-2025-11-17-013519635.png" alt="Current Errors">
      </div>
      <p class="caption">This is how many errors I have as of writing this. (Right hand side, red icon #6)</p>
</section>
<section>
    <b>Progression</b>
<hr>
Going forward I hope to at least have exponential operations (shouldn't be too hard) and the logic gate display at the very least. Any additional things I may add include function and sequence tables, equation presets, or factorization. After all of what I have time to do is done, I will widely spread it across the internet to garner as many responses I can get in order to see if I succeeded in teaching literally anybody anything.
<br><span style="color:#777777; font-size:10px">I do realize this one is less visually appealing... I beg of you, don't smite me.</span>
</section>
<section>
  <b>Commented on...</b>
  <hr>
  <a href='https://addiepfall25.edublogs.org/2025/11/14/endangered-animals-how-is-it-going' target=“_blank”>Addie's <i>Endangered Animals! How is it going?</i></a><br>
  <a href='https://kaidensfall25.edublogs.org/2025/11/15/process-of-the-informational-sports-cards-project' target=“_blank”>Kaiden's <i>Process of The Informational Sports Cards Project</i></a><br>
  <a href='https://ianabfall125.edublogs.org/2025/11/13/a-new-way-of-treatment-progress' target=“_blank”>Iana's <i>A New Way Of Treatment – Progress</i></a>
  <br><span style="color:#777777; font-size:10px">I thought the em dash in the name was neat.</span>
</section>
   </div>
    </div>
    <div class="card">
      <h3>VHDL Sources (fetched from repo)</h3>
      <h4>adder_subtractor_16.vhd</h4>
      <pre id="vhdl1">Loading…</pre>
      <h4>tb_adder_subtractor_16.vhd</h4>
      <pre id="vhdl2">Loading…</pre>
    </div>
  </div>
  <script>
(function(){
  const toggle = document.getElementById('comments-toggle');
  const overlay = document.getElementById('comments-overlay');
  const iframe = document.getElementById('comments-iframe');
  const backdrop = overlay.querySelector('[data-role="backdrop"]');
  const closeBtn = overlay.querySelector('.close-btn');

  function showOverlay(){
    overlay.classList.add('show');
    overlay.setAttribute('aria-hidden','false');
    toggle.setAttribute('aria-expanded','true');
    setTimeout(()=> {
      try { iframe.contentWindow && iframe.contentWindow.focus(); } catch(e){}
    },200);
  }
  function hideOverlay(){
    overlay.classList.remove('show');
    overlay.setAttribute('aria-hidden','true');
    toggle.setAttribute('aria-expanded','false');
  }

  toggle.addEventListener('click', ()=>{
    if (overlay.classList.contains('show')) hideOverlay();
    else showOverlay();
  });
  backdrop.addEventListener('click', hideOverlay);
  closeBtn.addEventListener('click', hideOverlay);
  window.addEventListener('keydown', (e)=>{
    if (e.key === 'Escape' && overlay.classList.contains('show')) hideOverlay();
  });
})();
    function add_sub_16(a, b, sub) {
      const mask = 0xFFFF;
      a = a & mask; b = b & mask;
      const bx = b ^ (sub ? mask : 0);
      let result = 0;
      let carry = sub ? 1 : 0;
      for (let i = 0; i < 16; ++i) {
        const ai = (a >> i) & 1;
        const bi = (bx >> i) & 1;
        const s = ai ^ bi ^ carry;
        result |= (s << i);
        const cout = (ai & bi) | (bi & carry) | (ai & carry);
        carry = cout;
      }
      const carryOut = carry & 1;
      carry = sub ? 1 : 0;
      for (let i = 0; i < 15; ++i) {
        const ai = (a >> i) & 1;
        const bi = (bx >> i) & 1;
        const cout = (ai & bi) | (bi & carry) | (ai & carry);
        carry = cout;
      }
      const carryIntoMSB = carry & 1;
      const overflow = (carryIntoMSB ^ carryOut) & 1;
      const zero = ((result & mask) === 0) ? 1 : 0;
      const signed = (result & 0x8000) ? result - 0x10000 : result;
      return {
        A: a, B: b, SUB: sub,
        Result: result & mask, Result_signed: signed,
        CarryOut: carryOut, Overflow: overflow, Zero: zero,
        hex: '0x' + ((result & mask).toString(16).toUpperCase().padStart(4,'0'))
      };
    }
    function mul_16(a, b) {
      const mask = 0xFFFF;
      a = a & mask; b = b & mask;
      let product = 0;
      for (let i = 0; i < 16; ++i) {
        if ((b >> i) & 1) {
          product = (product + (a << i)) >>> 0;
        }
      }
      const low = product & 0xFFFF;
      const high = (product >>> 16) & 0xFFFF;
      const signed32 = (product & 0x80000000) ? product - 0x100000000 : product;
      const overflow = high !== 0;
      return {
        A: a, B: b,
        Product32: product >>> 0,
        High16: high, Low16: low,
        ProductHex: '0x' + (product >>> 0).toString(16).toUpperCase().padStart(8,'0'),
        Overflow: overflow
      };
    }
    function div_16(a, b) {
      const mask = 0xFFFF;
      a = a & mask; b = b & mask;
      if (b === 0) return { DivByZero: true };
      const q = Math.floor(a / b) & mask;
      const r = a % b;
      return { A: a, B: b, Quotient: q, Remainder: r, QHex: '0x' + q.toString(16).toUpperCase().padStart(4,'0'), RHex: '0x' + r.toString(16).toUpperCase().padStart(4,'0') };
    }
    function toBin16(x) {
      return (x & 0xFFFF).toString(2).padStart(16,'0').replace(/(.{4})/g,'$1 ').trim();
    }
    async function tryFetchPaths(id, paths) {

      for (const p of paths) {
        try {
          const r = await fetch(p, {cache: 'no-store'});
          if (!r.ok) throw new Error(`HTTP ${r.status}`);
          const txt = await r.text();
          return {ok: true, text: txt, path: p};
        } catch (e) {
        }
      }
      return {ok: false};
    }
    async function fetchVHDL(id, filename) {
      const candidates = [];
      candidates.push('./' + filename);
      const basePath = window.location.pathname.replace(/\/[^/]*$/, '/');
      candidates.push(basePath + filename);
      candidates.push('/' + filename);
      const res = await tryFetchPaths(id, candidates);
      const target = document.getElementById(id);
      if (res.ok) {
        target.textContent = res.text;
      } else {
        target.textContent = `${filename} could not be fetched. CORS or file serving may be blocking access.\n` +
          `If you're testing locally, run a simple HTTP server in the folder.`;
      }
    }
    document.getElementById('compute').addEventListener('click', () => {
      const A = parseInt(document.getElementById('A').value || '0', 10);
      const B = parseInt(document.getElementById('B').value || '0', 10);
      const OP = document.getElementById('OP').value;
      if (OP === 'ADD') {
        const res = add_sub_16(A, B, 0);
        document.getElementById('resultDisplay').textContent = `Add: ${res.Result} (signed=${res.Result_signed}) HEX=${res.hex}`;
        document.getElementById('flags').textContent = `CarryOut=${res.CarryOut}  Overflow=${res.Overflow}  Zero=${res.Zero}`;
        document.getElementById('binary').textContent = toBin16(res.Result);
      } else if (OP === 'SUB') {
        const res = add_sub_16(A, B, 1);
        document.getElementById('resultDisplay').textContent = `Sub: ${res.Result} (signed=${res.Result_signed}) HEX=${res.hex}`;
        document.getElementById('flags').textContent = `CarryOut=${res.CarryOut}  Overflow=${res.Overflow}  Zero=${res.Zero}`;
        document.getElementById('binary').textContent = toBin16(res.Result);
      } else if (OP === 'MUL') {
        const res = mul_16(A, B);
        document.getElementById('resultDisplay').textContent = `Product = ${res.Product32} (HIGH=0x${res.High16.toString(16).toUpperCase().padStart(4,'0')} LOW=0x${res.Low16.toString(16).toUpperCase().padStart(4,'0')}) HEX=${res.ProductHex}`;
        document.getElementById('flags').textContent = `Overflow=${res.Overflow ? 1 : 0}`;
        const full = (res.Product32 >>> 0).toString(2).padStart(32,'0');
        document.getElementById('binary').textContent = full.slice(0,16) + ' ' + full.slice(16);
      } else if (OP === 'DIV') {
        const res = div_16(A, B);
        if (res.DivByZero) {
          document.getElementById('resultDisplay').textContent = 'Error: divide by zero';
          document.getElementById('flags').textContent = '';
          document.getElementById('binary').textContent = '';
        } else {
          document.getElementById('resultDisplay').textContent = `Quotient=${res.Quotient} Remainder=${res.Remainder} QHEX=${res.QHex} RHEX=${res.RHex}`;
          document.getElementById('flags').textContent = '';
          document.getElementById('binary').textContent = toBin16(res.Quotient) + '  (quotient)\n' + toBin16(res.Remainder) + '  (remainder)';
        }
      }
    });
    document.getElementById('compute').click();
  fetchVHDL('vhdl1','adder_subtractor_16.vhd');
  fetchVHDL('vhdl2','tb_adder_subtractor_16.vhd');
  </script>
</body>

</html>
